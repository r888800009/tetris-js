<canvas id="screen" width="600" height="600" style="border:1px solid #555555;"></canvas>
<script >
var screen;
var sct;      
var w = 600, h = 600;  
var BlockSize = 20;
var fps = 100.0;
var backGround = "#555555";
var noBlockColor = "#222222";
var blockColor = "#22FFFF";
var blockBackGroundColor = "#000000";
var gameW = 10, gameH = 20, gameX = 10, gameY = 10;
var readyDisplayX = (gameW + 1) * BlockSize, readyDisplayY = gameY;
var game, gameStart = true;
var timerGame;
var pointX = 0, pointY = 0;
var blocks = [
    [
        1,1,1,1,
        0,0,0,0,
        0,0,0,0,
        0,0,0,0
    ],
    [
        2,2,2,0,
        0,0,2,0,
        0,0,0,0,
        0,0,0,0
    ],
    [
        3,3,3,0,
        3,0,0,0,
        0,0,0,0,
        0,0,0,0
    ],
    [
        4,4,0,0,
        4,4,0,0,
        0,0,0,0,
        0,0,0,0
    ],
    [
        0,5,5,0,
        5,5,0,0,
        0,0,0,0,
        0,0,0,0
    ],
    [
        6,6,6,0,
        0,6,0,0,
        0,0,0,0,
        0,0,0,0
    ],
    [
        7,7,0,0,
        0,7,7,0,
        0,0,0,0,
        0,0,0,0
    ],
];

var useBlock;
var readyBlock;
function init()
{
    newKey();
    newMap();
}

function newMap()
{
    game = new Array(gameW);
    for (var x = 0; x < gameW; x++) {
            game[x] = new Array(gameH);
        for (var y = 0; y < gameH; y++) {
            game[x][y] = 0;

        }
    }
    newBlock();
}

function newBlock()
{
    var blockUse = Math.floor(Math.random() * 7);
    readyBlock = Math.floor(Math.random() * 7);
    useBlock = new Array(4 * 4);
    for (var i = 0; i < useBlock.length; i++) {
        useBlock[i] = blocks[blockUse][i];
    }
    pointX = gameW / 2 - 2;
    pointY = 0;
}

function main()
{
    screen1 = document.getElementById('screen');   
    sct = screen1.getContext('2d');
    sct.fillStyle = backGround;
    
    init();
    timer = setInterval(display, 1000.0 / fps)
    timerGame = setInterval(tick, 500)
    clear();
    return 0; 
}

function tick()
{
    moveDown();
}

function clear() 
{
    sct.fillStyle = backGround;
    sct.fillRect(0, 0, w, h);
}

function gameDisplay()
{
    sct.fillStyle = blockBackGroundColor;
    sct.fillRect(gameX, gameY, BlockSize * gameW, BlockSize * gameH);
    
    for (var x = 0; x < gameW; x++) {
        for (var y = 0; y < gameH; y++) {
            blockPaint(gameX, gameY, x, y, game[x][y]);
        }
    }
}

var colors=["#996600","#6688EE","#FFCC00","#CC9933","#EE99CC","#9933EE","#BB99FF"];
function blockPaint(onScreenX, onScreenY, x, y, useBlackground)
{
    if (useBlackground == 0) {
            sct.fillStyle = noBlockColor;
    } else {
            sct.fillStyle = colors[useBlackground - 1];
    }
    sct.fillRect(onScreenX + (BlockSize) * x + 1, onScreenY + (BlockSize) * y + 1, BlockSize - 2, BlockSize - 2);
}

function readyDisplay()
{
    for (var x = 0; x < 4; x++) {
        for (var y = 0; y < 4; y++) {
            if(blocks[readyBlock][x + y * 4] != 0) {
                blockPaint(readyDisplayX, readyDisplayY, x, y, blocks[readyBlock][x + y * 4]);    
            }   
        }
   }
}

function pointDisplay()
{
    for (var x = 0; x < 4; x++) {
        for (var y = 0; y < 4; y++) {
            if (useBlock[x + y * 4] != 0) {
                blockPaint(gameX, gameY, pointX + x, pointY + y, useBlock[x + y * 4]);    
            }
        }
    }
}

function display()
{
    clear();
    gameDisplay();
    readyDisplay();
    pointDisplay();
}

function gameOver()
{
    gameStart = false;
    window.clearInterval(timerGame);
}

function collisionTest(addX, addY)
{
    for (var x = 0; x < 4; x++) {
        for (var y = 0; y < 4; y++) {
            if (useBlock[x + y * 4] != 0) {
                if (pointX + x + addX <  0     ||
                    pointX + x + addX >= gameW ||
                    pointY + y + addY >= gameH )
                {
                    return true;
                } else if (game[pointX + x + addX][pointY + y + addY] != 0) {
                    return true;
                }
            }
        }
    }
    return false;
}

function lineTest()
{

}
//event
var keyBool = new Array(128);
function newKey()
{
    for (var i = 0; i < keyBool.length; i++) {
        keyBool[i] = false;
    }
}

function rotate() 
{

}

function moveRight() 
{
    if (!collisionTest(1, 0))
        pointX++;
}

function moveLeft() 
{
    if (!collisionTest(-1, 0))
        pointX--;
}

function moveDown()
{
    if (gameStart == true) {
        if (!collisionTest(0, 1))
            pointY++;
        else {
            if (pointY == 0)
                gameOver();
            for (var x = 0; x < 4; x++) {
                for (var y = 0; y < 4; y++) {
                    if (useBlock[x + y * 4] != 0) {
                        game[pointX + x][pointY + y] = useBlock[x + y * 4];
                    }
                }
                lineTest();
            }
            newBlock();
        }
    }
}

function keyDown(e){
    e = e || window.event;

    if (e.keyCode < 128) {
        if (keyBool[e.keyCode] == false) {
            keyBool[e.keyCode] == true;
            console.log("keyDown");
            
            if([38, 40, 37, 39].indexOf(e.keyCode) > -1) {
                e.preventDefault();
            }

            if (e.keyCode == '38') //up
                rotate();
            
            if (e.keyCode == '40') //down
                moveDown();
            
            if (e.keyCode == '37') //left
                moveLeft();
            
            if (e.keyCode == '39') //right
                moveRight();
        }

    }
}

function keyUp(e)
{
    e = e || window.event;

    if (e.keyCode < 128) {
        if (keyBool[e.keyCode] == true) {
            keyBool[e.keyCode] == false;
        }
    }
}
window.onload=main;
window.onkeydown=keyDown;
window.onkeyup=keyUp;
</script>
<br>
The game is not done.
<a href="https://github.com/r888800009/tetris-js"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
<br>
<a href="https://github.com/r888800009/">r888800009</a>
